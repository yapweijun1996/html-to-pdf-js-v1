<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Exporter - Browser Functionality Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        .warning { background-color: #fff3cd; color: #856404; }
        
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        .test-content {
            border: 2px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            background-color: white;
        }
        
        .test-content h1 { color: #007bff; }
        .test-content h2 { color: #28a745; }
        .test-content h3 { color: #ffc107; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        
        .highlight {
            background-color: yellow;
            padding: 2px 4px;
        }
        
        blockquote {
            border-left: 4px solid #007bff;
            margin: 20px 0;
            padding-left: 20px;
            font-style: italic;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>üß™ PDF Exporter - Browser Functionality Test</h1>
    
    <div class="status info">
        <strong>Status:</strong> Ready to test frontend-only HTML to PDF conversion
    </div>
    
    <div class="test-section">
        <h2>üéØ Test Controls</h2>
        <button onclick="runBasicTest()">üî¨ Run Basic Test</button>
        <button onclick="runAdvancedTest()">üöÄ Run Advanced Test</button>
        <button onclick="runPerformanceTest()">‚ö° Performance Test</button>
        <button onclick="clearResults()">üßπ Clear Results</button>
        
        <div id="test-results"></div>
    </div>
    
    <!-- Test Content for PDF Generation -->
    <div id="test-content" class="test-content">
        <h1>üìÑ Sample Document for PDF Export</h1>
        
        <h2>üé® Text Formatting Tests</h2>
        <p>This paragraph contains <strong>bold text</strong>, <em>italic text</em>, 
        <u>underlined text</u>, <s>strikethrough text</s>, <mark class="highlight">highlighted text</mark>, 
        <small>small text</small>, and <code>inline code</code>.</p>
        
        <p>Mathematical expressions: H<sub>2</sub>O and E=mc<sup>2</sup></p>
        
        <h2>üìã List Tests</h2>
        <h3>Unordered List</h3>
        <ul>
            <li>First item</li>
            <li>Second item with <strong>bold</strong> text</li>
            <li>Third item
                <ul>
                    <li>Nested item 1</li>
                    <li>Nested item 2</li>
                </ul>
            </li>
            <li>Fourth item</li>
        </ul>
        
        <h3>Ordered List</h3>
        <ol>
            <li>First numbered item</li>
            <li>Second numbered item</li>
            <li>Third numbered item
                <ol>
                    <li>Nested numbered item</li>
                    <li>Another nested item</li>
                </ol>
            </li>
        </ol>
        
        <h2>üìä Table Test</h2>
        <table>
            <thead>
                <tr>
                    <th>Feature</th>
                    <th>Status</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Text Rendering</td>
                    <td>‚úÖ Working</td>
                    <td>Supports multiple fonts and styles</td>
                </tr>
                <tr>
                    <td>List Rendering</td>
                    <td>‚úÖ Working</td>
                    <td>Nested lists supported</td>
                </tr>
                <tr>
                    <td>Table Rendering</td>
                    <td>‚úÖ Working</td>
                    <td>Basic table support</td>
                </tr>
                <tr>
                    <td>Image Support</td>
                    <td>üîÑ Partial</td>
                    <td>Data URLs and HTTPS images</td>
                </tr>
            </tbody>
        </table>
        
        <h2>üíª Code Block Test</h2>
        <div class="code-block">
            <pre><code>// JavaScript Example
async function generatePDF() {
    try {
        const result = await PDFExporter.init({
            selector: '#content',
            filename: 'document.pdf',
            debug: true
        });
        console.log('Success:', result);
    } catch (error) {
        console.error('Error:', error);
    }
}</code></pre>
        </div>
        
        <h2>üí¨ Quote Test</h2>
        <blockquote>
            "This PDF Exporter library successfully converts HTML to PDF entirely in the browser, 
            without requiring any server-side processing. It's a powerful frontend-only solution."
        </blockquote>
        
        <h2>üîó Link Test</h2>
        <p>Visit <a href="https://github.com">GitHub</a> for more information about web development.</p>
        
        <hr>
        
        <h2>üìù Form Elements Test</h2>
        <p>Form elements are rendered as text representations:</p>
        <p>Text input: <input type="text" value="Sample text" readonly></p>
        <p>Checkbox: <input type="checkbox" checked> Checked option</p>
        <p>Radio: <input type="radio" checked> Selected option</p>
        <p>Button: <button type="button">Sample Button</button></p>
    </div>
    
    <script src="pdf-exporter.js"></script>
    <script>
        let testResults = document.getElementById('test-results');
        
        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}:</strong> ${message}`;
            testResults.appendChild(div);
            testResults.scrollTop = testResults.scrollHeight;
        }
        
        function clearResults() {
            testResults.innerHTML = '';
            addResult('Test results cleared', 'info');
        }
        
        async function runBasicTest() {
            addResult('üî¨ Starting basic PDF generation test...', 'info');
            
            try {
                // Test basic functionality
                const startTime = Date.now();
                
                const result = await PDFExporter.init({
                    selector: '#test-content',
                    filename: 'basic-test.pdf',
                    debug: true,
                    onProgress: (info) => {
                        addResult(`Progress: ${info.phase} - ${info.percentage}%`, 'info');
                    },
                    onWarning: (warning) => {
                        addResult(`Warning: ${warning.message}`, 'warning');
                    }
                });
                
                const duration = Date.now() - startTime;
                addResult(`‚úÖ Basic test completed successfully in ${duration}ms`, 'success');
                addResult(`üìä Stats: ${result.pages} pages, ${result.elementsProcessed} elements processed`, 'success');
                
                if (result.warnings && result.warnings.length > 0) {
                    addResult(`‚ö†Ô∏è ${result.warnings.length} warnings generated`, 'warning');
                }
                
            } catch (error) {
                addResult(`‚ùå Basic test failed: ${error.message}`, 'error');
                console.error('Basic test error:', error);
            }
        }
        
        async function runAdvancedTest() {
            addResult('üöÄ Starting advanced PDF generation test...', 'info');
            
            try {
                const startTime = Date.now();
                
                const result = await PDFExporter.init({
                    selector: '#test-content',
                    filename: 'advanced-test.pdf',
                    pageSize: 'A4',
                    margin: 50,
                    fontSize: 11,
                    h1FontSize: 20,
                    h2FontSize: 16,
                    bulletIndent: 25,
                    tableCellPadding: 8,
                    debug: true,
                    onProgress: (info) => {
                        addResult(`Advanced Progress: ${info.phase} - ${info.percentage}%`, 'info');
                    },
                    onError: (error) => {
                        addResult(`Error: ${error.message}`, 'error');
                    },
                    onWarning: (warning) => {
                        addResult(`Warning: ${warning.message}`, 'warning');
                    }
                });
                
                const duration = Date.now() - startTime;
                addResult(`‚úÖ Advanced test completed in ${duration}ms`, 'success');
                addResult(`üìä Advanced Stats: ${result.pages} pages, ${result.elementsProcessed} elements`, 'success');
                
            } catch (error) {
                addResult(`‚ùå Advanced test failed: ${error.message}`, 'error');
                console.error('Advanced test error:', error);
            }
        }
        
        async function runPerformanceTest() {
            addResult('‚ö° Starting performance test...', 'info');
            
            try {
                // Create a larger test content
                const originalContent = document.getElementById('test-content').innerHTML;
                const testContent = document.getElementById('test-content');
                
                // Duplicate content multiple times for performance testing
                let largeContent = originalContent;
                for (let i = 0; i < 3; i++) {
                    largeContent += `<h2>üìÑ Duplicate Section ${i + 1}</h2>` + originalContent;
                }
                testContent.innerHTML = largeContent;
                
                const startTime = Date.now();
                let lastProgressTime = startTime;
                
                const result = await PDFExporter.init({
                    selector: '#test-content',
                    filename: 'performance-test.pdf',
                    debug: false, // Disable debug for performance
                    onProgress: (info) => {
                        const now = Date.now();
                        const progressDuration = now - lastProgressTime;
                        addResult(`‚ö° ${info.phase}: ${info.percentage}% (+${progressDuration}ms)`, 'info');
                        lastProgressTime = now;
                    }
                });
                
                const totalDuration = Date.now() - startTime;
                
                // Restore original content
                testContent.innerHTML = originalContent;
                
                addResult(`‚úÖ Performance test completed in ${totalDuration}ms`, 'success');
                addResult(`üìä Performance: ${result.pages} pages, ${result.elementsProcessed} elements`, 'success');
                addResult(`‚ö° Speed: ${Math.round(result.elementsProcessed / (totalDuration / 1000))} elements/second`, 'success');
                
            } catch (error) {
                addResult(`‚ùå Performance test failed: ${error.message}`, 'error');
                console.error('Performance test error:', error);
                
                // Restore original content on error
                const originalContent = `<h1>üìÑ Sample Document for PDF Export</h1>...`; // Simplified for error case
                document.getElementById('test-content').innerHTML = originalContent;
            }
        }
        
        // Browser compatibility check
        function checkBrowserCompatibility() {
            const features = {
                'Canvas API': !!document.createElement('canvas').getContext,
                'Fetch API': !!window.fetch,
                'Blob API': !!window.Blob,
                'URL API': !!window.URL,
                'WeakMap': !!window.WeakMap,
                'Async/Await': (async () => {})().constructor.name === 'AsyncFunction',
                'ES6 Classes': !!class {},
                'Arrow Functions': (() => {}).constructor.name === 'Function'
            };
            
            addResult('üîç Browser Compatibility Check:', 'info');
            for (const [feature, supported] of Object.entries(features)) {
                const status = supported ? '‚úÖ' : '‚ùå';
                const type = supported ? 'success' : 'error';
                addResult(`${status} ${feature}: ${supported ? 'Supported' : 'Not Supported'}`, type);
            }
        }
        
        // Run compatibility check on page load
        window.addEventListener('load', () => {
            addResult('üåê PDF Exporter Browser Test Page Loaded', 'success');
            checkBrowserCompatibility();
            addResult('üìã Ready to run tests. Click the buttons above to start.', 'info');
        });
        
        // Error handling for uncaught errors
        window.addEventListener('error', (event) => {
            addResult(`üí• Uncaught Error: ${event.error.message}`, 'error');
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            addResult(`üí• Unhandled Promise Rejection: ${event.reason}`, 'error');
        });
    </script>
</body>
</html> 